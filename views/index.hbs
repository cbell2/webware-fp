<body style="background: #e8e8e8">

<nav class="shadow navbar sticky-top navbar-dark navbar-expand-md" style=" position: sticky; top: 0; background-image: linear-gradient(to right, #02a6ff, #00e9ff) !important;">
    <a class="navbar-brand" href="/" style="color:white; font-size: 30px; font-weight: bold; text-shadow: 2px 4px 3px rgba(0,0,0,0.3);">Yeat</a>
    <button class="navbar-toggler" style="border-color: white;" type="button" data-toggle="collapse" data-target="#navbarText"
            aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarText">

        <ul class="navbar-nav mr-auto">
            <input class="form-control mr-sm-2" style="width: 400px" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" style="color: white; border-color: white;" type="submit">Search</button>
        </ul>
        <span class="navbar-text">
        <a href="/logout" class="nav-link" style="color: white; text-decoration: underline; font-weight: bold; font-size: 15px;"
        >Log Out</a>
      </span>
        <span class="navbar-text">
        <a id="loginA" class="nav-link" data-toggle="modal" data-target="#loggedInModal" style="color: white; text-decoration: underline; font-weight: bold; font-size: 15px"
           href="#">My Events</a>
      </span>
    </div>
</nav>

<div class="col-9" style="background-color: #e8e8e8; height: 100%; float: left; padding-right: 0px; padding-left: 0px;">
<button id="addevent" onclick=goToCreate() style="width:55px;border-radius:50%;color:white;background-color:#00e9ff;font-size:30px;font-weight:600;text-align:center;display:inline-block;margin: 4px 2px;padding:2px;cursor:pointer">+</button>
    {{#each ownedEvents}}
        <div class="card shadow" style="width: 100%; margin-top: 10px; display: inline-block; margin-bottom: 10px;">
            <div class="col-3" style="float: left; padding-left: 0px; padding-right: 0px">
                <img class="card-img-top" src="{{this.image}}" alt="Card image cap" style="width: 100%; height: 100%;">
            </div>
            <div class="col-10" >
                <div class="card-body" style="padding: 0px;">
                    <h5 class="card-title">{{this.name}}</h5>
                    <p class="card-text">{{this.description}}</p>
                </div>
            </div>
            <div class="col-3" style="position: absolute; top: 70px; right: -85px">
                <a href="#" class="btn btn-delete">Close Event</a>
                <a href="#" class="btn btn-primary">{{this.date}}</a>
                <a href="#" class="btn btn-primary">{{this.attending.length}} / {{this.maxAttendance}}</a>
            </div>
            <!--  users that have requested-->

        </div>
    {{/each}}

    {{#each allEvents}}
        <div class="card shadow" style="width: 100%; margin-top: 10px; display: inline-block; margin-bottom: 10px;">
            <div class="row">
            <div class="col-3" style="float: left; padding-left: 0px; padding-right: 0px">
                <img class="card-img-top" src={{this.image}} alt="Card image cap" style="width: 100%; height: 100%;">
            </div>
            <div class="col-9" >
                <div class="card-body" style="padding: 0px; float: left">
                    <h4 class="card-title">{{this.name}}</h4>
                    <h5 class="card-title" style="margin-top: -18px; color: #717171">{{this.date}}</h5>
                    <p class="card-text">{{this.description}}</p>
                    <br>
                    <br>
                    {{!-- <a href="#" class="btn btn-primary" style="position: absolute; bottom: 18px">{{this.currentAttendance}} / {{this.maxAttendance}}</a> --}}
                    <div class="row">
                    <a id="requestToAttend" onclick="requestToJoin(this)" style="font-weight: bold; border-color: #02a6ff; background-color: #02a6ff; color: white; position: absolute; left: 15px; bottom: 15px" class="btn btn-primary">Request to Attend</a>
                    <h5 style="color: #717171; position: absolute; right: 30px; bottom: 10px">Currently: {{this.currentAttendance}} / {{this.maxAttendance}} Attendees</h5>
                    {{!-- <div style="position: absolute; top: 1px; right: 16px; width: 20px; height: 20px; background-color:red">X</div> --}}
                    <i class="fas fa-check-square" style="color: #ffc107; font-size: 25px; position: absolute; top: 1px; right: 20px; width: 20px; height: 20px;"></i>
                    </div>
                </div>
            </div>
            {{!-- <div id="{{this._id}}" class="findThis col-3" style="position: relative; float: right">
                <a id="requestToAttend" onclick="requestToJoin(this)" class="btn btn-primary">Request to Attend</a>
                <a href="#" class="btn btn-primary">{{this.date}}</a>
                <a href="#" class="btn btn-primary">{{this.currentAttendance}} / {{this.maxAttendance}}</a>
            </div> --}}
        </div>
        </div>
    {{/each}}
</div>

<div class="col-3" style="float: right; text-align: center; position: fixed; right: 0px; height: 100%; background-color: #00e9ff; display: block; border-left: #28d3e2; border-left-style: solid">
    <img class="shadow-sm" src="images/Profile.png" style="width:60%; margin-left:5%; border-radius: 60%; margin-top: 5%">
    <h3 style="color:white; text-shadow: 2px 4px 3px rgba(0,0,0,0.3);">John Doe</h3>
    <h5 style="color:white; text-shadow: 2px 4px 3px rgba(0,0,0,0.3);">This is a short bio This is a short bio This is
        a short bio v</h5>
    <h7 style="color:white; text-shadow: 2px 4px 3px rgba(0,0,0,0.3);">Favorite Food: YeetSauce</h7>
    <br><br>
    <div style=" height:13%; background-image:     linear-gradient(
      rgba(0, 233, 255, 0.45), 
      rgba(2, 166, 255, 0.45)
    ), url(images/FishPic.jpg); background-size: cover; margin-bottom:5px; border-radius: 10px; color:white; font-size: 50px; text-shadow: 2px 4px 3px rgba(0,0,0,0.3);">
        My Events
    </div>
    <div style=" height:13%; background-image:     linear-gradient(
      rgba(0, 233, 255, 0.45), 
      rgba(2, 166, 255, 0.45)
    ), url(images/FishPic.jpg); background-size: cover; margin-bottom:5px; border-radius: 10px; color:white; font-size: 50px; text-shadow: 2px 4px 3px rgba(0,0,0,0.3);">
        Accepted
    </div>
    <div style=" height:13%; background-image:     linear-gradient(
      rgba(0, 233, 255, 0.45), 
      rgba(2, 166, 255, 0.45)
    ), url(images/FishPic.jpg); background-size: cover; margin-bottom:5px; border-radius: 10px; color:white; font-size: 50px; text-shadow: 2px 4px 3px rgba(0,0,0,0.3);">
        Pending
    </div>
    </body>

</div>
<script> 
function goToCreate() {
	window.location.href = 'createevent', true;
}
function requestToJoin(e) {
    var joinThis = $(e).closest(".findThis").attr('id');
    $.ajax({
        url: '/main/requestEvent',
        type: 'post',
        data: {
            eventId: joinThis
        },
        success: function (response) {
            alert("Successfully requested to join. You probably hate seeing events so uhh Chris make this pretty plox?");
            location.reload();
        },
        error: function () {

            alert("Requesting to join event failed");
        }
    });

}
</script>